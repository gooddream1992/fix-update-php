<?php

$arrDoneDeals = array();
$strUniqueId = date("H:i:s");

require_once './functions/simplehtmldom/simple_html_dom.php';
require_once 'classes/finediff.php';

define('LOG_FILENAME_C','/tmp/groupon_test');
write_app_log("starting test script...\n");


// correct output for deal at no-limit-boot-camp
  $dealx = "a:27:{s:3:\"adr\";a:2:{i:0;a:6:{s:3:\"lat\";s:9:\"33.857979\";s:3:\"lng\";s:11:\"-117.774081\";s:12:\"addressline1\";s:17:\"100 S Quintana Dr\";s:8:\"locality\";s:17:\"Anaheim, CA 92807\";s:7:\"zipcode\";s:5:\"92807\";s:6:\"google\";O:8:\"stdClass\":5:{s:18:\"address_components\";a:8:{i:0;O:8:\"stdClass\":3:{s:9:\"long_name\";s:3:\"100\";s:10:\"short_name\";s:3:\"100\";s:5:\"types\";a:1:{i:0;s:13:\"street_number\";}}i:1;O:8:\"stdClass\":3:{s:9:\"long_name\";s:13:\"S Quintana Dr\";s:10:\"short_name\";s:13:\"S Quintana Dr\";s:5:\"types\";a:1:{i:0;s:5:\"route\";}}i:2;O:8:\"stdClass\":3:{s:9:\"long_name\";s:7:\"Anaheim\";s:10:\"short_name\";s:7:\"Anaheim\";s:5:\"types\";a:2:{i:0;s:8:\"locality\";i:1;s:9:\"political\";}}i:3;O:8:\"stdClass\":3:{s:9:\"long_name\";s:30:\"Anaheim-Santa Ana-Garden Grove\";s:10:\"short_name\";s:30:\"Anaheim-Santa Ana-Garden Grove\";s:5:\"types\";a:2:{i:0;s:27:\"administrative_area_level_3\";i:1;s:9:\"political\";}}i:4;O:8:\"stdClass\":3:{s:9:\"long_name\";s:6:\"Orange\";s:10:\"short_name\";s:6:\"Orange\";s:5:\"types\";a:2:{i:0;s:27:\"administrative_area_level_2\";i:1;s:9:\"political\";}}i:5;O:8:\"stdClass\":3:{s:9:\"long_name\";s:10:\"California\";s:10:\"short_name\";s:2:\"CA\";s:5:\"types\";a:2:{i:0;s:27:\"administrative_area_level_1\";i:1;s:9:\"political\";}}i:6;O:8:\"stdClass\":3:{s:9:\"long_name\";s:13:\"United States\";s:10:\"short_name\";s:2:\"US\";s:5:\"types\";a:2:{i:0;s:7:\"country\";i:1;s:9:\"political\";}}i:7;O:8:\"stdClass\":3:{s:9:\"long_name\";s:5:\"92807\";s:10:\"short_name\";s:5:\"92807\";s:5:\"types\";a:1:{i:0;s:11:\"postal_code\";}}}s:17:\"formatted_address\";s:41:\"100 S Quintana Dr, Anaheim, CA 92807, USA\";s:8:\"geometry\";O:8:\"stdClass\":2:{s:8:\"location\";O:8:\"stdClass\":2:{s:3:\"lat\";d:33.8579790000000002692104317247867584228515625;s:3:\"lng\";d:-117.774080999999995356120052747428417205810546875;}s:13:\"location_type\";s:7:\"ROOFTOP\";}s:13:\"partial_match\";b:1;s:5:\"types\";a:1:{i:0;s:14:\"street_address\";}}}i:1;a:6:{s:3:\"lat\";s:10:\"33.8598013\";s:3:\"lng\";s:12:\"-117.7960777\";s:12:\"addressline1\";s:19:\"5462 E La Palma Ave\";s:8:\"locality\";s:17:\"Anaheim, CA 92807\";s:7:\"zipcode\";s:5:\"92807\";s:6:\"google\";O:8:\"stdClass\":4:{s:18:\"address_components\";a:8:{i:0;O:8:\"stdClass\":3:{s:9:\"long_name\";s:4:\"5462\";s:10:\"short_name\";s:4:\"5462\";s:5:\"types\";a:1:{i:0;s:13:\"street_number\";}}i:1;O:8:\"stdClass\":3:{s:9:\"long_name\";s:14:\"E La Palma Ave\";s:10:\"short_name\";s:14:\"E La Palma Ave\";s:5:\"types\";a:1:{i:0;s:5:\"route\";}}i:2;O:8:\"stdClass\":3:{s:9:\"long_name\";s:7:\"Anaheim\";s:10:\"short_name\";s:7:\"Anaheim\";s:5:\"types\";a:2:{i:0;s:8:\"locality\";i:1;s:9:\"political\";}}i:3;O:8:\"stdClass\":3:{s:9:\"long_name\";s:30:\"Anaheim-Santa Ana-Garden Grove\";s:10:\"short_name\";s:30:\"Anaheim-Santa Ana-Garden Grove\";s:5:\"types\";a:2:{i:0;s:27:\"administrative_area_level_3\";i:1;s:9:\"political\";}}i:4;O:8:\"stdClass\":3:{s:9:\"long_name\";s:6:\"Orange\";s:10:\"short_name\";s:6:\"Orange\";s:5:\"types\";a:2:{i:0;s:27:\"administrative_area_level_2\";i:1;s:9:\"political\";}}i:5;O:8:\"stdClass\":3:{s:9:\"long_name\";s:10:\"California\";s:10:\"short_name\";s:2:\"CA\";s:5:\"types\";a:2:{i:0;s:27:\"administrative_area_level_1\";i:1;s:9:\"political\";}}i:6;O:8:\"stdClass\":3:{s:9:\"long_name\";s:13:\"United States\";s:10:\"short_name\";s:2:\"US\";s:5:\"types\";a:2:{i:0;s:7:\"country\";i:1;s:9:\"political\";}}i:7;O:8:\"stdClass\":3:{s:9:\"long_name\";s:5:\"92807\";s:10:\"short_name\";s:5:\"92807\";s:5:\"types\";a:1:{i:0;s:11:\"postal_code\";}}}s:17:\"formatted_address\";s:43:\"5462 E La Palma Ave, Anaheim, CA 92807, USA\";s:8:\"geometry\";O:8:\"stdClass\":2:{s:8:\"location\";O:8:\"stdClass\":2:{s:3:\"lat\";d:33.8594604000000032328898669220507144927978515625;s:3:\"lng\";d:-117.799036099999995030884747393429279327392578125;}s:13:\"location_type\";s:7:\"ROOFTOP\";}s:5:\"types\";a:1:{i:0;s:14:\"street_address\";}}}}s:16:\"deal_source_name\";s:11:\"Groupon.com\";s:13:\"deal_deadline\";s:18:\"02/28/2011 11:59PM\";s:18:\"unix_deal_deadline\";s:10:\"1298966340\";s:14:\"deal_permalink\";s:18:\"no-limit-boot-camp\";s:14:\"deal_perma_url\";s:47:\"http://www.groupon.com/deals/no-limit-boot-camp\";s:6:\"amount\";s:2:\"30\";s:8:\"discount\";s:3:\"169\";s:5:\"value\";i:199;s:3:\"url\";s:47:\"http://www.groupon.com/deals/no-limit-boot-camp\";s:5:\"price\";s:3:\"\$30\";s:5:\"photo\";s:74:\"http://www.groupon.com/images/site_images/0623/4533/No-Limit-Boot-Camp.jpg\";s:11:\"photo_small\";s:83:\"http://www.groupon.com/images/site_images/0623/4533/No-Limit-Boot-Camp_sidedeal.jpg\";s:12:\"photo_medium\";s:82:\"http://www.groupon.com/images/site_images/0623/4533/No-Limit-Boot-Camp_sidebar.jpg\";s:13:\"control_title\";s:86:\"\$30 for a One-Month Unlimited Membership at No Limit Boot Camp in Anaheim (\$199 Value)\";s:13:\"email_subject\";s:0:\"\";s:14:\"comment_number\";s:2:\"27\";s:14:\"discussion_url\";s:53:\"http://www.groupon.com/deals/no-limit-boot-camp/posts\";s:13:\"division_name\";s:13:\"Orange County\";s:11:\"description\";s:1313:\"<p>Boot camps are an excellent way to train for strongman contests and prep for afternoons of rearranging Grandma's rocking-chair collection. Get fit for the sake of family with today's Groupon: for \$30, you get a one-month unlimited membership at <a href=\"http://www.nolimitbootcamp.com/\">No Limit Boot Camp</a> in Anaheim (a \$199 value).</p>                                <p>No Limit Boot Camp whips clients into tiptop shape with 60-minute indoor and outdoor group training sessions. Exercise amateurs and fitness freaks of all ages gather to firm up limbs and send metabolisms into overdrive with a regimen of instructor-guided stretching, core strengthening, resistance training, and cardio. The workouts, along with No Limit's personalized online nutrition plans, help participants shed pounds and slip easily into their old Little League uniforms. </p>                                <p>Prospective exercisers can check the <a href=\"http://www.nolimitbootcamp.com/locations-and-times/\">schedule</a>— which includes evening al fresco workouts at Eucalyptus Park and indoor morning meetings six days a week—and need only bring running shoes, water, a towel, and an inspiring photo of Mr. T. All boot campers receive a yoga mat, No Limit T-shirt, and a bag, and reap the rewards of group motivation. </p>\";s:11:\"number_sold\";s:3:\"496\";s:9:\"tipped_at\";s:59:\"Tipped at 8:07AM with <span class=\"number\">25</span> bought\";s:7:\"website\";s:31:\"http://www.nolimitbootcamp.com/\";s:12:\"company_name\";s:18:\"No Limit Boot Camp\";s:10:\"fine_print\";a:2:{i:0;s:20:\"Expires Aug 29, 2011\";i:1;s:204:\"Limit 1 per person, may buy multiple as gifts. <b>Must activate membership by 9/29/11, membership expires 1 month from activation. Registration required.</b> Non-transferable. Not valid with other offers.\";}s:10:\"highlights\";a:5:{i:0;s:29:\"Indoor &amp; outdoor workouts\";i:1;s:24:\"Sessions six days a week\";i:2;s:29:\"Boost metabolism &amp; energy\";i:3;s:28:\"Online custom nutrition plan\";i:4;s:29:\"All ages &amp; levels welcome\";}s:8:\"comments\";a:0:{}}";
//$dealx = "a:27:{s:3:\"adr\";a:2:{i:0;a:6:{s:3:\"lat\";s:9:\"33.857979\";s:3:\"lng\";s:11:\"-117.774081\";s:12:\"addressline1\";s:17:\"100 S Quintana Dr\";s:8:\"locality\";s:17:\"Anaheim, CA 92807\";s:7:\"zipcode\";s:5:\"92807\";s:6:\"google\";O:8:\"stdClass\":5:{s:18:\"address_components\";a:8:{i:0;O:8:\"stdClass\":3:{s:9:\"long_name\";s:3:\"100\";s:10:\"short_name\";s:3:\"100\";s:5:\"types\";a:1:{i:0;s:13:\"street_number\";}}i:1;O:8:\"stdClass\":3:{s:9:\"long_name\";s:13:\"S Quintana Dr\";s:10:\"short_name\";s:13:\"S Quintana Dr\";s:5:\"types\";a:1:{i:0;s:5:\"route\";}}i:2;O:8:\"stdClass\":3:{s:9:\"long_name\";s:7:\"Anaheim\";s:10:\"short_name\";s:7:\"Anaheim\";s:5:\"types\";a:2:{i:0;s:8:\"locality\";i:1;s:9:\"political\";}}i:3;O:8:\"stdClass\":3:{s:9:\"long_name\";s:30:\"Anaheim-Santa Ana-Garden Grove\";s:10:\"short_name\";s:30:\"Anaheim-Santa Ana-Garden Grove\";s:5:\"types\";a:2:{i:0;s:27:\"administrative_area_level_3\";i:1;s:9:\"political\";}}i:4;O:8:\"stdClass\":3:{s:9:\"long_name\";s:6:\"Orange\";s:10:\"short_name\";s:6:\"Orange\";s:5:\"types\";a:2:{i:0;s:27:\"administrative_area_level_2\";i:1;s:9:\"political\";}}i:5;O:8:\"stdClass\":3:{s:9:\"long_name\";s:10:\"California\";s:10:\"short_name\";s:2:\"CA\";s:5:\"types\";a:2:{i:0;s:27:\"administrative_area_level_1\";i:1;s:9:\"political\";}}i:6;O:8:\"stdClass\":3:{s:9:\"long_name\";s:13:\"United States\";s:10:\"short_name\";s:2:\"US\";s:5:\"types\";a:2:{i:0;s:7:\"country\";i:1;s:9:\"political\";}}i:7;O:8:\"stdClass\":3:{s:9:\"long_name\";s:5:\"92807\";s:10:\"short_name\";s:5:\"92807\";s:5:\"types\";a:1:{i:0;s:11:\"postal_code\";}}}s:17:\"formatted_address\";s:41:\"100 S Quintana Dr, Anaheim, CA 92807, USA\";s:8:\"geometry\";O:8:\"stdClass\":3:{s:8:\"location\";O:8:\"stdClass\":2:{s:3:\"lat\";d:33.8579790000000002692104317247867584228515625;s:3:\"lng\";d:-117.774080999999995356120052747428417205810546875;}s:13:\"location_type\";s:7:\"ROOFTOP\";s:8:\"viewport\";O:8:\"stdClass\":2:{s:9:\"northeast\";O:8:\"stdClass\":2:{s:3:\"lat\";d:33.8611266206801673206427949480712413787841796875;s:3:\"lng\";d:-117.7709333793197998829782591201364994049072265625;}s:9:\"southwest\";O:8:\"stdClass\":2:{s:3:\"lat\";d:33.8548313793198332177780685015022754669189453125;s:3:\"lng\";d:-117.77722862068020504011656157672405242919921875;}}}s:13:\"partial_match\";b:1;s:5:\"types\";a:1:{i:0;s:14:\"street_address\";}}}i:1;a:6:{s:3:\"lat\";s:10:\"33.8598013\";s:3:\"lng\";s:12:\"-117.7960777\";s:12:\"addressline1\";s:19:\"5462 E La Palma Ave\";s:8:\"locality\";s:17:\"Anaheim, CA 92807\";s:7:\"zipcode\";s:5:\"92807\";s:6:\"google\";O:8:\"stdClass\":4:{s:18:\"address_components\";a:8:{i:0;O:8:\"stdClass\":3:{s:9:\"long_name\";s:4:\"5462\";s:10:\"short_name\";s:4:\"5462\";s:5:\"types\";a:1:{i:0;s:13:\"street_number\";}}i:1;O:8:\"stdClass\":3:{s:9:\"long_name\";s:14:\"E La Palma Ave\";s:10:\"short_name\";s:14:\"E La Palma Ave\";s:5:\"types\";a:1:{i:0;s:5:\"route\";}}i:2;O:8:\"stdClass\":3:{s:9:\"long_name\";s:7:\"Anaheim\";s:10:\"short_name\";s:7:\"Anaheim\";s:5:\"types\";a:2:{i:0;s:8:\"locality\";i:1;s:9:\"political\";}}i:3;O:8:\"stdClass\":3:{s:9:\"long_name\";s:30:\"Anaheim-Santa Ana-Garden Grove\";s:10:\"short_name\";s:30:\"Anaheim-Santa Ana-Garden Grove\";s:5:\"types\";a:2:{i:0;s:27:\"administrative_area_level_3\";i:1;s:9:\"political\";}}i:4;O:8:\"stdClass\":3:{s:9:\"long_name\";s:6:\"Orange\";s:10:\"short_name\";s:6:\"Orange\";s:5:\"types\";a:2:{i:0;s:27:\"administrative_area_level_2\";i:1;s:9:\"political\";}}i:5;O:8:\"stdClass\":3:{s:9:\"long_name\";s:10:\"California\";s:10:\"short_name\";s:2:\"CA\";s:5:\"types\";a:2:{i:0;s:27:\"administrative_area_level_1\";i:1;s:9:\"political\";}}i:6;O:8:\"stdClass\":3:{s:9:\"long_name\";s:13:\"United States\";s:10:\"short_name\";s:2:\"US\";s:5:\"types\";a:2:{i:0;s:7:\"country\";i:1;s:9:\"political\";}}i:7;O:8:\"stdClass\":3:{s:9:\"long_name\";s:5:\"92807\";s:10:\"short_name\";s:5:\"92807\";s:5:\"types\";a:1:{i:0;s:11:\"postal_code\";}}}s:17:\"formatted_address\";s:43:\"5462 E La Palma Ave, Anaheim, CA 92807, USA\";s:8:\"geometry\";O:8:\"stdClass\":3:{s:8:\"location\";O:8:\"stdClass\":2:{s:3:\"lat\";d:33.8594604000000032328898669220507144927978515625;s:3:\"lng\";d:-117.799036099999995030884747393429279327392578125;}s:13:\"location_type\";s:7:\"ROOFTOP\";s:8:\"viewport\";O:8:\"stdClass\":2:{s:9:\"northeast\";O:8:\"stdClass\":2:{s:3:\"lat\";d:33.86260802068017028432223014533519744873046875;s:3:\"lng\";d:-117.7958884793197995577429537661373615264892578125;}s:9:\"southwest\";O:8:\"stdClass\":2:{s:3:\"lat\";d:33.85631277931982907603014609776437282562255859375;s:3:\"lng\";d:-117.80218372068020471488125622272491455078125;}}}s:5:\"types\";a:1:{i:0;s:14:\"street_address\";}}}}s:16:\"deal_source_name\";s:11:\"Groupon.com\";s:13:\"deal_deadline\";s:18:\"02/28/2011 11:59PM\";s:18:\"unix_deal_deadline\";s:10:\"1298966340\";s:14:\"deal_permalink\";s:18:\"no-limit-boot-camp\";s:14:\"deal_perma_url\";s:47:\"http://www.groupon.com/deals/no-limit-boot-camp\";s:6:\"amount\";s:2:\"30\";s:8:\"discount\";s:3:\"169\";s:5:\"value\";i:199;s:3:\"url\";s:47:\"http://www.groupon.com/deals/no-limit-boot-camp\";s:5:\"price\";s:3:\"\$30\";s:5:\"photo\";s:74:\"http://www.groupon.com/images/site_images/0623/4533/No-Limit-Boot-Camp.jpg\";s:11:\"photo_small\";s:83:\"http://www.groupon.com/images/site_images/0623/4533/No-Limit-Boot-Camp_sidedeal.jpg\";s:12:\"photo_medium\";s:82:\"http://www.groupon.com/images/site_images/0623/4533/No-Limit-Boot-Camp_sidebar.jpg\";s:13:\"control_title\";s:86:\"\$30 for a One-Month Unlimited Membership at No Limit Boot Camp in Anaheim (\$199 Value)\";s:13:\"email_subject\";s:0:\"\";s:14:\"comment_number\";s:2:\"27\";s:14:\"discussion_url\";s:53:\"http://www.groupon.com/deals/no-limit-boot-camp/posts\";s:13:\"division_name\";s:13:\"Orange County\";s:11:\"description\";s:1313:\"<p>Boot camps are an excellent way to train for strongman contests and prep for afternoons of rearranging Grandma's rocking-chair collection. Get fit for the sake of family with today's Groupon: for \$30, you get a one-month unlimited membership at <a href=\"http://www.nolimitbootcamp.com/\">No Limit Boot Camp</a> in Anaheim (a \$199 value).</p>                                <p>No Limit Boot Camp whips clients into tiptop shape with 60-minute indoor and outdoor group training sessions. Exercise amateurs and fitness freaks of all ages gather to firm up limbs and send metabolisms into overdrive with a regimen of instructor-guided stretching, core strengthening, resistance training, and cardio. The workouts, along with No Limit's personalized online nutrition plans, help participants shed pounds and slip easily into their old Little League uniforms. </p>                                <p>Prospective exercisers can check the <a href=\"http://www.nolimitbootcamp.com/locations-and-times/\">schedule</a>— which includes evening al fresco workouts at Eucalyptus Park and indoor morning meetings six days a week—and need only bring running shoes, water, a towel, and an inspiring photo of Mr. T. All boot campers receive a yoga mat, No Limit T-shirt, and a bag, and reap the rewards of group motivation. </p>\";s:11:\"number_sold\";s:3:\"496\";s:9:\"tipped_at\";s:59:\"Tipped at 8:07AM with <span class=\"number\">25</span> bought\";s:7:\"website\";s:31:\"http://www.nolimitbootcamp.com/\";s:12:\"company_name\";s:18:\"No Limit Boot Camp\";s:10:\"fine_print\";a:2:{i:0;s:20:\"Expires Aug 29, 2011\";i:1;s:204:\"Limit 1 per person, may buy multiple as gifts. <b>Must activate membership by 9/29/11, membership expires 1 month from activation. Registration required.</b> Non-transferable. Not valid with other offers.\";}s:10:\"highlights\";a:5:{i:0;s:29:\"Indoor &amp; outdoor workouts\";i:1;s:24:\"Sessions six days a week\";i:2;s:29:\"Boost metabolism &amp; energy\";i:3;s:28:\"Online custom nutrition plan\";i:4;s:29:\"All ages &amp; levels welcome\";}s:8:\"comments\";a:0:{}}";
//$dealx = "a:27:{s:3:\"adr\";a:2:{i:0;a:6:{s:3:\"lat\";s:9:\"33.857979\";s:3:\"lng\";s:11:\"-117.774081\";s:12:\"addressline1\";s:17:\"100 S Quintana Dr\";s:8:\"locality\";s:17:\"Anaheim, CA 92807\";s:7:\"zipcode\";s:5:\"92807\";s:6:\"google\";O:8:\"stdClass\":5:{s:5:\"types\";a:1:{i:0;s:14:\"street_address\";}s:17:\"formatted_address\";s:41:\"100 S Quintana Dr, Anaheim, CA 92807, USA\";s:18:\"address_components\";a:8:{i:0;O:8:\"stdClass\":3:{s:9:\"long_name\";s:3:\"100\";s:10:\"short_name\";s:3:\"100\";s:5:\"types\";a:1:{i:0;s:13:\"street_number\";}}i:1;O:8:\"stdClass\":3:{s:9:\"long_name\";s:13:\"S Quintana Dr\";s:10:\"short_name\";s:13:\"S Quintana Dr\";s:5:\"types\";a:1:{i:0;s:5:\"route\";}}i:2;O:8:\"stdClass\":3:{s:9:\"long_name\";s:7:\"Anaheim\";s:10:\"short_name\";s:7:\"Anaheim\";s:5:\"types\";a:2:{i:0;s:8:\"locality\";i:1;s:9:\"political\";}}i:3;O:8:\"stdClass\":3:{s:9:\"long_name\";s:30:\"Anaheim-Santa Ana-Garden Grove\";s:10:\"short_name\";s:30:\"Anaheim-Santa Ana-Garden Grove\";s:5:\"types\";a:2:{i:0;s:27:\"administrative_area_level_3\";i:1;s:9:\"political\";}}i:4;O:8:\"stdClass\":3:{s:9:\"long_name\";s:6:\"Orange\";s:10:\"short_name\";s:6:\"Orange\";s:5:\"types\";a:2:{i:0;s:27:\"administrative_area_level_2\";i:1;s:9:\"political\";}}i:5;O:8:\"stdClass\":3:{s:9:\"long_name\";s:10:\"California\";s:10:\"short_name\";s:2:\"CA\";s:5:\"types\";a:2:{i:0;s:27:\"administrative_area_level_1\";i:1;s:9:\"political\";}}i:6;O:8:\"stdClass\":3:{s:9:\"long_name\";s:13:\"United States\";s:10:\"short_name\";s:2:\"US\";s:5:\"types\";a:2:{i:0;s:7:\"country\";i:1;s:9:\"political\";}}i:7;O:8:\"stdClass\":3:{s:9:\"long_name\";s:5:\"92807\";s:10:\"short_name\";s:5:\"92807\";s:5:\"types\";a:1:{i:0;s:11:\"postal_code\";}}}s:8:\"geometry\";O:8:\"stdClass\":3:{s:8:\"location\";O:8:\"stdClass\":2:{s:3:\"lat\";d:33.8579790000000002692104317247867584228515625;s:3:\"lng\";d:-117.774080999999995356120052747428417205810546875;}s:13:\"location_type\";s:7:\"ROOFTOP\";s:8:\"viewport\";O:8:\"stdClass\":2:{s:9:\"southwest\";O:8:\"stdClass\":2:{s:3:\"lat\";d:33.85483140000000190639184438623487949371337890625;s:3:\"lng\";d:-117.77722860000000082436599768698215484619140625;}s:9:\"northeast\";O:8:\"stdClass\":2:{s:3:\"lat\";d:33.86112659999999863202901906333863735198974609375;s:3:\"lng\";d:-117.7709334000000040987288230098783969879150390625;}}}s:13:\"partial_match\";b:1;}}i:1;a:6:{s:3:\"lat\";s:10:\"33.8598013\";s:3:\"lng\";s:12:\"-117.7960777\";s:12:\"addressline1\";s:19:\"5462 E La Palma Ave\";s:8:\"locality\";s:17:\"Anaheim, CA 92807\";s:7:\"zipcode\";s:5:\"92807\";s:6:\"google\";O:8:\"stdClass\":4:{s:5:\"types\";a:1:{i:0;s:14:\"street_address\";}s:17:\"formatted_address\";s:43:\"5462 E La Palma Ave, Anaheim, CA 92807, USA\";s:18:\"address_components\";a:8:{i:0;O:8:\"stdClass\":3:{s:9:\"long_name\";s:4:\"5462\";s:10:\"short_name\";s:4:\"5462\";s:5:\"types\";a:1:{i:0;s:13:\"street_number\";}}i:1;O:8:\"stdClass\":3:{s:9:\"long_name\";s:14:\"E La Palma Ave\";s:10:\"short_name\";s:14:\"E La Palma Ave\";s:5:\"types\";a:1:{i:0;s:5:\"route\";}}i:2;O:8:\"stdClass\":3:{s:9:\"long_name\";s:7:\"Anaheim\";s:10:\"short_name\";s:7:\"Anaheim\";s:5:\"types\";a:2:{i:0;s:8:\"locality\";i:1;s:9:\"political\";}}i:3;O:8:\"stdClass\":3:{s:9:\"long_name\";s:30:\"Anaheim-Santa Ana-Garden Grove\";s:10:\"short_name\";s:30:\"Anaheim-Santa Ana-Garden Grove\";s:5:\"types\";a:2:{i:0;s:27:\"administrative_area_level_3\";i:1;s:9:\"political\";}}i:4;O:8:\"stdClass\":3:{s:9:\"long_name\";s:6:\"Orange\";s:10:\"short_name\";s:6:\"Orange\";s:5:\"types\";a:2:{i:0;s:27:\"administrative_area_level_2\";i:1;s:9:\"political\";}}i:5;O:8:\"stdClass\":3:{s:9:\"long_name\";s:10:\"California\";s:10:\"short_name\";s:2:\"CA\";s:5:\"types\";a:2:{i:0;s:27:\"administrative_area_level_1\";i:1;s:9:\"political\";}}i:6;O:8:\"stdClass\":3:{s:9:\"long_name\";s:13:\"United States\";s:10:\"short_name\";s:2:\"US\";s:5:\"types\";a:2:{i:0;s:7:\"country\";i:1;s:9:\"political\";}}i:7;O:8:\"stdClass\":3:{s:9:\"long_name\";s:5:\"92807\";s:10:\"short_name\";s:5:\"92807\";s:5:\"types\";a:1:{i:0;s:11:\"postal_code\";}}}s:8:\"geometry\";O:8:\"stdClass\":3:{s:8:\"location\";O:8:\"stdClass\":2:{s:3:\"lat\";d:33.8594604000000032328898669220507144927978515625;s:3:\"lng\";d:-117.799036099999995030884747393429279327392578125;}s:13:\"location_type\";s:7:\"ROOFTOP\";s:8:\"viewport\";O:8:\"stdClass\":2:{s:9:\"southwest\";O:8:\"stdClass\":2:{s:3:\"lat\";d:33.8563127999999977646439219824969768524169921875;s:3:\"lng\";d:-117.8021837000000004991306923329830169677734375;}s:9:\"northeast\";O:8:\"stdClass\":2:{s:3:\"lat\";d:33.86260800000000159570845426060259342193603515625;s:3:\"lng\";d:-117.7958885000000037734935176558792591094970703125;}}}}}}s:16:\"deal_source_name\";s:11:\"Groupon.com\";s:13:\"deal_deadline\";s:18:\"02/28/2011 11:59PM\";s:18:\"unix_deal_deadline\";s:10:\"1298966340\";s:14:\"deal_permalink\";s:18:\"no-limit-boot-camp\";s:14:\"deal_perma_url\";s:47:\"http://www.groupon.com/deals/no-limit-boot-camp\";s:6:\"amount\";s:2:\"30\";s:8:\"discount\";s:3:\"169\";s:5:\"value\";i:199;s:3:\"url\";s:47:\"http://www.groupon.com/deals/no-limit-boot-camp\";s:5:\"price\";s:3:\"\$30\";s:5:\"photo\";s:74:\"http://www.groupon.com/images/site_images/0623/4533/No-Limit-Boot-Camp.jpg\";s:11:\"photo_small\";s:83:\"http://www.groupon.com/images/site_images/0623/4533/No-Limit-Boot-Camp_sidedeal.jpg\";s:12:\"photo_medium\";s:82:\"http://www.groupon.com/images/site_images/0623/4533/No-Limit-Boot-Camp_sidebar.jpg\";s:13:\"control_title\";s:86:\"\$30 for a One-Month Unlimited Membership at No Limit Boot Camp in Anaheim (\$199 Value)\";s:13:\"email_subject\";s:0:\"\";s:14:\"comment_number\";s:2:\"27\";s:14:\"discussion_url\";s:53:\"http://www.groupon.com/deals/no-limit-boot-camp/posts\";s:13:\"division_name\";s:13:\"Orange County\";s:11:\"description\";s:1313:\"<p>Boot camps are an excellent way to train for strongman contests and prep for afternoons of rearranging Grandma's rocking-chair collection. Get fit for the sake of family with today's Groupon: for \$30, you get a one-month unlimited membership at <a href=\"http://www.nolimitbootcamp.com/\">No Limit Boot Camp</a> in Anaheim (a \$199 value).</p>                                <p>No Limit Boot Camp whips clients into tiptop shape with 60-minute indoor and outdoor group training sessions. Exercise amateurs and fitness freaks of all ages gather to firm up limbs and send metabolisms into overdrive with a regimen of instructor-guided stretching, core strengthening, resistance training, and cardio. The workouts, along with No Limit's personalized online nutrition plans, help participants shed pounds and slip easily into their old Little League uniforms. </p>                                <p>Prospective exercisers can check the <a href=\"http://www.nolimitbootcamp.com/locations-and-times/\">schedule</a>— which includes evening al fresco workouts at Eucalyptus Park and indoor morning meetings six days a week—and need only bring running shoes, water, a towel, and an inspiring photo of Mr. T. All boot campers receive a yoga mat, No Limit T-shirt, and a bag, and reap the rewards of group motivation. </p>\";s:11:\"number_sold\";s:3:\"496\";s:9:\"tipped_at\";s:59:\"Tipped at 8:07AM with <span class=\"number\">25</span> bought\";s:7:\"website\";s:31:\"http://www.nolimitbootcamp.com/\";s:12:\"company_name\";s:18:\"No Limit Boot Camp\";s:10:\"fine_print\";a:2:{i:0;s:20:\"Expires Aug 29, 2011\";i:1;s:204:\"Limit 1 per person, may buy multiple as gifts. <b>Must activate membership by 9/29/11, membership expires 1 month from activation. Registration required.</b> Non-transferable. Not valid with other offers.\";}s:10:\"highlights\";a:5:{i:0;s:29:\"Indoor &amp; outdoor workouts\";i:1;s:24:\"Sessions six days a week\";i:2;s:29:\"Boost metabolism &amp; energy\";i:3;s:28:\"Online custom nutrition plan\";i:4;s:29:\"All ages &amp; levels welcome\";}s:8:\"comments\";a:0:{}}";

	$url = 'http://www.groupon.com/deals/no-limit-boot-camp';

	$data = DealFeedPeer::getGrouponData($url, TRUE);
//	vdump($data);

// this might change... we con't care.
unset($data['deal']['post_to_blogs']);

$deal = serialize($data['deal']);
$deal = str_replace("\r\n", " ", $deal);
$deal = str_replace("\n", " ", $deal);

//vdump(addcslashes($deal,'"$'));
//vdump(($deal));
//vdump(($dealx));

$isdiff = $dealx != $deal?true:false;
vdump($isdiff);

function diff_string2($string1, $string2) {
	// show what is different...
	for ($i = 0; $i < strlen($string1); $i++) {
		if ($string1{$i} != $string2{$i}) {
			vdump('different at char: '.$i);
			$strDiff = substr($string1, 0, $i).'<font color=red>'.substr($string1, $i);
			break;
		}
	}
	$strFfid = strrev($strDiff);
	$strLaed = strrev($string2);
	for ($i = 0; $i < strlen($strFfid); $i++) {
		if ($strFfid{$i} != $strLaed{$i}) {
			vdump('different at char: '.$i);
			$strDiff_rev = substr($strFfid, 0, $i).'>tnof/<'.substr($strFfid, $i);
			return strrev($strDiff_rev);
		}
	}
	return null;
}

function diff_string($string1, $string2) {
	// show what is different...
	
	$string1 = str_replace("{", "{\n", $string1);
	$string1 = str_replace("}", "}\n\n", $string1);
	$string1 = str_replace(";", ";\n\t", $string1);
	
	$string2 = str_replace("{", "{\n", $string2);
	$string2 = str_replace("}", "}\n\n", $string2);
	$string2 = str_replace(";", ";\n\t", $string2);
	
	$opcodes = FineDiff::getDiffOpcodes($string1, $string2);
	return FineDiff::renderDiffToHTMLFromOpcodes($string1, $opcodes);
}

if ($isdiff) {
	vdump(diff_string($deal, $dealx));
	echo "New: ".diff_string2($deal, $dealx);
	echo "\n\n<br><br>\n\nOld: ". diff_string2($dealx, $deal);
	
//	send_unittest_results('Groupon unit test differs http://dealn.it/events-parse_groupon-test.htm New: '.diff_string2($deal, $dealx));
}

write_app_log("quitting test script.\n");
exit;

